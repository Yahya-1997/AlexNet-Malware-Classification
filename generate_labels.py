import os
from pathlib import Path as path
import numpy as np

root_dir = os.path.join(os.path.dirname(os.path.abspath(__file__)) , "Original_dataset")
class_map = np.load('class_map.npy', allow_pickle=True)
class_map = class_map.item()
#print(class_map)
#function to read basename and save filename and class id to a txt file
def directory_discover(path_, file_):
    entries = path(path_)
    for entry in entries.iterdir():
        if os.path.isdir(entry):
            directory_discover(entry, file_)
        elif os.path.isfile(entry):
            #print("\n"+ str(entry))
            #print(entry)
            class_name = os.path.basename(os.path.dirname(entry)).replace("_", " ")
            #print(class_name) # str(entry).replace(" ","_").split('\\')[-2]
            #class_name = class_name.split('\\')
            file_.write(str(entry).replace(" ","_") + ' ' + str(class_map[class_name]) + '\n')
            #print(class_name)

#give val.txt or train.txt according to dataset
file1 = open('train.txt', 'w')
directory_discover(os.path.join(root_dir, "train"), file1)
file1.close()
file2 = open('val.txt', 'w')
directory_discover(os.path.join(root_dir, "valid"), file2)
file2.close()